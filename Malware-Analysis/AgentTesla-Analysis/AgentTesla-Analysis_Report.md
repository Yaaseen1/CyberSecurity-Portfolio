# AgentTesla Malware Analysis Report

> Author: Yaaseen Sheriff
> 
> Date: 6-11-2025
> 
> Sample SHA256: `4CFE4B8EA8B615D55DC301A57BB5A1525CE4486C7FC6AE430C3E6FEC5F301E07`  
> Type: .NET Keylogger / Credential Stealer  
> Tools Used: PEStudio, dnSpy, Procmon, Regshot, Wireshark

---

## üîç 1. Overview

This report documents the static and dynamic analysis of a suspected AgentTesla malware sample. The sample was analyzed in a controlled, host-only virtual machine environment. Emphasis was placed on identifying obfuscation techniques, system modification behaviors, and network activity.

---

## üß™ 2. Static Analysis

### Tool: PEStudio

- Binary is **.NET executable**, compiled in C#
- No valid code signing certificate
- Uses **Crypto Obfuscator** (evident from path and string entropy)
- High resource section (86%+) ‚Üí encrypted payload likely stored within
- Key suspicious indicators:
  - `CreateDecryptor` + `MemoryStream` (classic memory-based payload decryption)
  - High entropy + obfuscated strings

üì∏ Screenshot: `Tool-Demos/PEStudio_Analysis.jpg`

---

## üß† 3. Decompiled Code Review

### Tool: dnSpy

- Obfuscated methods with random character names
- Repeated use of string arrays and `MemoryStream` operations
- Likely decrypts and reconstructs keylogging or exfiltration logic at runtime
- No hardcoded domains or IPs visible in plaintext

üì∏ Screenshot: `Tool-Demos/dnSpy_Obfuscated_Code.jpg`

---

## üßæ 4. Behavioral Analysis (Procmon)

### Tool: Procmon

- Extensive `WriteFile` activity to:
  - `C:\Windows\System32\config\DEFAULT`
  - `SOFTWARE.LOG1` and `SOFTWARE.LOG2`
- Possible registry tampering or logging activity
- No file creation or execution of new processes observed
- Custom filters applied to isolate malware behavior

üì∏ Screenshots:
- `Procmon_AgentTesla_RegistryWrites.jpg`
- `Procmon_AgentTesla_Filters.jpg`

---

## üß¨ 5. Registry Change Snapshot

### Tool: Regshot

- **33 total registry changes**
  - 1 key added
  - 3 values added
  - 26 values modified
- Changes likely related to configuration or potential persistence

üì∏ Screenshot: `Regshot_AgentTesla_Changes.jpg`

---

## üåê 6. Network Traffic

### Tool: Wireshark

- No evidence of C2 traffic or outbound HTTP/DNS requests
- Traffic limited to:
  - mDNS
  - SSDP
  - DHCP (local traffic)
- Indicates:
  - Sample may be VM/sandbox-aware
  - Network communication may be delayed or encrypted
  - Host-only adapter blocked outbound communication

üì∏ Screenshot: `Wireshark_AgentTesla_NoExternalTraffic.jpg`

---

## üß† 7. Conclusion

This AgentTesla sample exhibits classic signs of obfuscated .NET malware:

- Heavy use of string encryption
- Memory-based payload delivery
- Registry interaction
- No external communication observed under test conditions

Although limited in observable behavior (no file drop or C2 activity), this analysis confirms the sample is designed for stealth and post-infection credential theft.

---

## üìÅ 8. Files & Evidence

| File | Description |
|------|-------------|
| `Tool-Demos/*.jpg` | Visual evidence of analysis |
| `AgentTesla-Analysis_Report.md` | This detailed summary |
| `README.md` | Overview of tools and folder structure |

---

## ‚ö†Ô∏è 9. Legal / Safety Notice

This analysis was performed in an isolated virtual lab. Do **not** execute malware on a host machine. All findings are for educational and career-building purposes.


